# Cowork - プロダクトコンセプト

## 一言で言うと

**エンジニアでない人が、Claude Codeの力を日常業務で使えるようにするWindowsデスクトップアプリ。**

## 背景と動機

Claude Cowork（Mac向け）のようなClaude Code UIラッパーは存在するが、Windows対応かつ非エンジニア向けのものがない。
ターゲットユーザーは、PCは使えるがCLIには馴染みのない非エンジニアの業務担当者。
CLIを直接使うのは現実的ではないが、Claude Codeの「ファイル操作・自動化・対話的問題解決」の能力は業務に大きく役立つ。

## 設計原則

### 1. APIをハックしない

Claude CodeのCLIをstdin/stdoutでラップする。`--output-format stream-json` プロトコルを使い、NDJSONストリームを解析して構造化されたイベントを取得する。
APIキーの管理やプロンプト設計をユーザーに押し付けず、Claude Codeが持つ機能（ツール使用、セッション管理、安全機構）をそのまま活かす。

### 2. 見えないものを見えるようにする

CLIで起きていることは、非エンジニアには何が起きているか分からない。
ツール呼び出し（Bash, Read, Write, Edit, Grep...）をリアルタイムで**人間が読める日本語に翻訳**して表示する。

例：
- `Bash: ls -la /home/user/documents` → 「フォルダの中身を一覧表示しています」
- `Write: /home/user/report.md` → 「report.md を作成しています」
- `Bash: git commit -m "fix"` → 「変更をGitに記録しています」

### 3. 承認も分かる言葉で

Claude Codeの権限確認（ファイル削除、コマンド実行など）を、そのまま英語のCLI表示ではなく、**何をしようとしているか日本語で説明するダイアログ**として表示する。
「このファイルを削除してもいいですか？」のように。

### 4. Windows ネイティブ

WSLではなく、Windows版Claude Codeを直接使う。
WSLのセットアップは非エンジニアにとってハードルが高すぎる。

## ターゲットユーザー

- **非エンジニア**（カテゴリB）
- PC操作はできるが、ターミナルやCLIは使わない
- 日中ひとりで仕事をしている
- ファイル整理、文書作成、データ管理、連絡調整が主な業務

## 想定ユースケース

### ファイルの整理
- ルールに基づくファイル自動仕分け（例：請求書を年月フォルダに振り分け）
- フォルダ構成の把握と説明

### Slack連携
- Slack Lists APIを使ったTODO同期
- Socket Modeによるリアルタイムイベント受信（パブリックURLが不要なデスクトップアプリ向き）
- ※Reminders APIは2023年3月に非推奨。Lists API（2025年9月リリース）を使用

### Google Drive連携
- OAuth2でドライブ内ファイルを閲覧
- ファイルをローカルにダウンロード → Claude Codeで処理

### ドキュメント管理SaaS連携（Docubase等）
- API経由でのドキュメント取得・操作

### 契約管理SaaS連携
- APIがないサービスの場合、スキルとして手順を定義し半自動化

### ワークフロー自動化（スキル）
- よく使う手順をスキルとして保存
- `{{パラメータ}}` でテンプレート化し、再利用可能に
- LLMコンポーネントを含むワークフローもスキルとして定義可能

### メール処理
- メール内容の整理、返信文案の作成

### TODO管理
- ローカルTODOリストの管理
- Slack Listsとの双方向同期

## UI構成

3ペインレイアウト：

```
┌──────────┬──────────────────┬──────────┐
│          │                  │          │
│ サイドバー │    チャット        │ アクティビティ│
│          │                  │          │
│ ・ファイル  │  メッセージ表示     │ ツール実行状況│
│ ・スキル   │  ストリーミング表示  │ （日本語翻訳）│
│ ・TODO    │                  │ ・実行中    │
│ ・設定    │  入力エリア        │ ・完了     │
│          │                  │ ・エラー    │
└──────────┴──────────────────┴──────────┘
```

- **左サイドバー**: ファイルブラウザ、スキル管理、TODOリスト、設定（Slack/GDrive）をタブ切替
- **中央チャット**: Claudeとの対話。メッセージバブル、ストリーミング表示、ウェルカム画面
- **右アクティビティ**: ツール実行の可視化。何をしているか日本語でリアルタイム表示

## 技術スタック

| レイヤー | 技術 | 理由 |
|---------|------|------|
| フレームワーク | Tauri v2 | 軽量、ネイティブ、Rustの安全性 |
| バックエンド | Rust | プロセス管理、ファイルI/O、APIクライアント |
| フロントエンド | React + TypeScript | コンポーネント設計、型安全 |
| Claude連携 | `claude -p --output-format stream-json --verbose` | 構造化ストリーム出力 |
| セッション継続 | `--resume` + session_id保存 | 会話の継続性 |
| ビルド | pnpm, GitHub Actions | Windows MSI/NSISインストーラー自動生成 |

## stream-jsonプロトコル

Claude Codeの `--output-format stream-json` は以下のイベントタイプをNDJSONで出力する：

- `system` - セッション情報
- `assistant` - Claudeの応答（テキスト、ツール呼び出し）
- `user` - ツール実行結果
- `result` - 最終結果
- `stream_event` - テキストデルタ（リアルタイムストリーミング）

これを解析し、フロントエンドにTauriイベントとして配信する。

## 将来の展望

- ルールエンジン（ファイル仕分けルールのGUI定義）
- Slack Socket Modeによるプッシュ通知統合
- スキルのインポート/エクスポート・共有
- 複数ワークスペース対応
- 自動スケジュール実行（定期タスク）
